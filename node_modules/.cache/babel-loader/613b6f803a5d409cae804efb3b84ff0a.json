{"remainingRequest":"/home/views/aquaman_view/node_modules/babel-loader/lib/index.js!/home/views/aquaman_view/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/views/aquaman_view/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/views/aquaman_view/src/views/instance/info.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/views/aquaman_view/src/views/instance/info.vue","mtime":1604759883992},{"path":"/home/views/aquaman_view/node_modules/cache-loader/dist/cjs.js","mtime":1601261325203},{"path":"/home/views/aquaman_view/node_modules/babel-loader/lib/index.js","mtime":1601261365222},{"path":"/home/views/aquaman_view/node_modules/cache-loader/dist/cjs.js","mtime":1601261325203},{"path":"/home/views/aquaman_view/node_modules/vue-loader/lib/index.js","mtime":1601261366062}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMubnVtYmVyLmNvbnN0cnVjdG9yIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IHsgSW5mb0RldGFpbCwgUG9ydEluZm9MaXN0LCBQb3J0SW5mb0RldGFpbCB9IGZyb20gIkAvYXBpL2luc3RhbmNlIjsKaW1wb3J0IHdhdmVzIGZyb20gIkAvZGlyZWN0aXZlL3dhdmVzIjsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJpbnN0YW5jZV9pbmZvIiwKICBkaXJlY3RpdmVzOiB7CiAgICB3YXZlczogd2F2ZXMKICB9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBwYW5uZWwxOiB0cnVlLAogICAgICBwYW5uZWwyOiB0cnVlLAogICAgICB0YWJsZUtleTogMCwKICAgICAgdGFibGVLZXkxOiAxLAogICAgICBiYW5uZXI6IFtdLAogICAgICBkaWFsb2c6IGZhbHNlLAogICAgICB3ZWJfZGlhbG9nOiBmYWxzZSwKICAgICAgc2VydmljZV9sb2FkaW5nOiB0cnVlLAogICAgICBmb3JtOiB7CiAgICAgICAgIl9pZCI6ICJzdHJpbmciLAogICAgICAgICJjcmVhdGVfYXQiOiAic3RyaW5nIiwKICAgICAgICAiaG9zdCI6ICJzdHJpbmciLAogICAgICAgICJob3N0bmFtZSI6ICJzdHJpbmciLAogICAgICAgICJob3N0bmFtZV90eXBlIjogInN0cmluZyIsCiAgICAgICAgImlzX2RlbGV0ZSI6IDAsCiAgICAgICAgIm1hYyI6ICJzdHJpbmciLAogICAgICAgICJuYW1lIjogInN0cmluZyIsCiAgICAgICAgInBvcnRfbGlzdCI6IFswXSwKICAgICAgICAicG9ydGlkX2xpc3QiOiBbInN0cmluZyJdLAogICAgICAgIC8vIFstXQogICAgICAgICJ0YXJnZXQiOiAic3RyaW5nIiwKICAgICAgICAidXBkYXRlX2F0IjogInN0cmluZyIsCiAgICAgICAgInZlbmRvciI6ICJzdHJpbmciCiAgICAgIH0sCiAgICAgIGxpc3Q6IFtdLAogICAgICBvcGVuX3BvcnQ6IFtdLAogICAgICB2dWxfaW5mbzoge30KICAgIH07CiAgfSwKICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkgewogICAgdmFyIGlkID0gdGhpcy4kcm91dGUucXVlcnkuaW5zdGFuY2VfaWQ7CiAgICB0aGlzLmdldERldGFpbChpZCk7CiAgfSwKICBtZXRob2RzOiB7CiAgICB0YWJsZVJvd0NsYXNzTmFtZTogZnVuY3Rpb24gdGFibGVSb3dDbGFzc05hbWUoX3JlZikgewogICAgICB2YXIgcm93ID0gX3JlZi5yb3c7CgogICAgICBpZiAocm93LnNldmVyaXR5ID09PSAzKSB7CiAgICAgICAgcmV0dXJuICdkYW5nZXItcm93JzsKICAgICAgfSBlbHNlIGlmIChyb3cuc2V2ZXJpdHkgPT09IDIpIHsKICAgICAgICByZXR1cm4gJ3dhcm5pbmctcm93JzsKICAgICAgfQoKICAgICAgcmV0dXJuICdzdWNjZXNzLXJvdyc7CiAgICB9LAogICAgdnVsX2RldGFpbDogZnVuY3Rpb24gdnVsX2RldGFpbChyb3cpIHsKICAgICAgdGhpcy5kaWFsb2cgPSB0cnVlOwogICAgICB0aGlzLnZ1bF9pbmZvID0gcm93OwogICAgfSwKICAgIGdldERldGFpbDogZnVuY3Rpb24gZ2V0RGV0YWlsKGlkKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICB2YXIgcXVlcnkgPSB7CiAgICAgICAgaW5zdGFuY2VfaWQ6IGlkCiAgICAgIH07CiAgICAgIEluZm9EZXRhaWwocXVlcnkpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgdmFyIHJlc3AgPSByZXNwb25zZS5kYXRhOwogICAgICAgIF90aGlzLmJhbm5lciA9IFtyZXNwLmhvc3QsIHJlc3AuaG9zdG5hbWUsIHJlc3AuaG9zdG5hbWVfdHlwZSwgcmVzcC5tYWMsIHJlc3AudmVuZG9yXTsKICAgICAgICBfdGhpcy5mb3JtID0gcmVzcDsKICAgICAgICBfdGhpcy5saXN0ID0gcmVzcG9uc2UuZGF0YS5wb3J0aW5mb19saXN0OwoKICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IF90aGlzLmxpc3QubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIGlmIChfdGhpcy5saXN0W2ldLnZ1bG5lcmFiaWxpdGllcy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIF90aGlzLm9wZW5fcG9ydC5wdXNoKE51bWJlcihfdGhpcy5saXN0W2ldLnBvcnQpKTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGNvbnNvbGUubG9nKF90aGlzLm9wZW5fcG9ydCk7CiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICBfdGhpcy5pc0xvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgIF90aGlzLnNlcnZpY2VfbG9hZGluZyA9IGZhbHNlOwogICAgICAgIH0sIDEgKiAxMDAwKTsKICAgICAgfSk7CiAgICB9CiAgfQp9Ow=="},{"version":3,"sources":["info.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"dashboard-editor-container\">\n      <div class=\"app-container\">\n           <div class=\"page-header\">\n                <button class=\"pan-btn pink-btn\" v-if=\"pannel1\" @click=\"pannel1=!pannel1\">[ - ] 资产信息</button>\n                <button class=\"pan-btn pink-btn\" v-else @click=\"pannel1=!pannel1\">[+] 资产信息</button>\n                <el-form ref=\"form\" v-if=\"pannel1\" :model=\"form\" label-width=\"80px\" size=\"mini\">\n                    <el-form-item></el-form-item>\n                    <el-form-item label=\"资产名称\">\n                        <el-tag type=\"info\">{{form.name}}</el-tag>\n                        <!-- <el-tag type=\"success\">{{form.state}}</el-tag> -->\n                    </el-form-item>\n                    <el-form-item label=\"Target\">\n                        <el-input v-model=\"form.target\" disabled style=\"width:250px\"></el-input>\n                    </el-form-item>\n                    <el-form-item label=\"IP 信息\">\n                        <el-tag type=\"info\">{{form.host}}</el-tag>\n                        <el-tag type=\"warning\" style=\"margin-left: 1%; color: yellow; background-color: gray\">{{form.ip_info}}</el-tag>\n                    </el-form-item>\n                    <el-form-item label=\"创建时间\">\n                        <el-tag type=\"info\">{{form.create_at}}</el-tag>\n                    </el-form-item>\n                    <el-form-item label=\"更新时间\">\n                        <el-tag type=\"info\">{{form.update_at}}</el-tag>\n                    </el-form-item>\n                   <el-form-item label=\"检测状态\" min-width=\"20px\"> <!--align=\"center\"-->\n                        <el-tag v-if=\"form.status=='Completed'\" effect=\"dark\" type=\"success\">\n                            <i  class=\"el-icon-finished\">{{ form.status }}</i>\n                        </el-tag>\n                        <el-tag v-else-if=\"form.status=='New'\">\n                            <i  class=\"el-icon-video-play\">{{ form.status }}</i>\n                        </el-tag>\n                        <el-tag v-else>\n                            <i  class=\"el-icon-loading\">{{ form.status }}</i>\n                        </el-tag>\n                    </el-form-item>\n                    <el-form-item label=\"Banner\">\n                        <el-checkbox-group v-model=\"banner\" fill=\"#FFA500\">\n                            <el-checkbox-button :label=\"form.host\" name=\"type\"></el-checkbox-button>\n                            <el-checkbox-button :label=\"form.hostname\" name=\"type\"></el-checkbox-button>\n                            <el-checkbox-button :label=\"form.hostname_type\" name=\"type\"></el-checkbox-button>\n                            <el-checkbox-button :label=\"form.mac\" name=\"type\"></el-checkbox-button>\n                            <el-checkbox-button :label=\"form.vendor\" name=\"type\"></el-checkbox-button>\n                        </el-checkbox-group>\n                    </el-form-item>\n                    <el-form-item label=\"高危端口\">\n                        <el-checkbox-group v-model=\"open_port\" fill=\"#CD0000\">\n                            <el-checkbox-button v-for=\"(j,jj) in form.port_list\" :key=\"jj\" :label=\"j\" name=\"type\"></el-checkbox-button>\n                        </el-checkbox-group>\n                    </el-form-item>\n                </el-form>\n           </div>\n           <div class=\"info-content\">\n                <button class=\"pan-btn green-btn\" v-if=\"pannel2\" @click=\"pannel2=!pannel2\">[ - ] 服务漏洞</button>\n                <button class=\"pan-btn green-btn\" v-else @click=\"pannel2=!pannel2\">[+] 服务漏洞</button>\n                <p />\n                <div v-if=\"pannel2\">\n                    <el-tabs v-if=\"list.length>0\" tab-position=\"left\" type=\"border-card\" style=\"height: 800px;\" v-loading=\"service_loading\" element-loading-text=\"玩命加载中\" element-loading-spinner=\"el-icon-loading\" element-loading-background=\"rgba(0, 0, 0, 0.8)\">\n                        <el-tab-pane v-for=\"(item, index) in list\" :key=\"index\" :label=\"item.port\">\n                            <el-form ref=\"form\" :model=\"item\" label-width=\"80px\" size=\"mini\">\n                                <el-form-item></el-form-item>\n                                <div v-if=\"item.web_fingerprint\">\n                                    <svg-icon style=\"float:left; height: 40px; width: 40px; color: #00BFFF\" icon-class=\"international\"/>   \n                                    <el-link type=\"primary\" style=\"font-size: 30px; line-height: 40px; margin-left:1%\" >{{item.name}}://{{form.host}}:{{item.port}}</el-link>\n                                    <p />\n                                </div>\n                                <div v-else>\n                                    <svg-icon style=\"float:left; height: 40px; width: 40px; color: #00BFFF\" icon-class=\"people\"/>   \n                                    <el-link type=\"primary\" style=\"font-size: 30px; line-height: 40px; margin-left:1%\" >{{item.name}}://{{form.host}}:{{item.port}}</el-link>\n                                    <p />\n                                </div>\n\n                                <el-form-item v-if=\"item['name'] && item['name'].indexOf('http') != -1\" label=\"标题\">\n                                    {{item.web_fingerprint['title']}}\n                                </el-form-item>\n                                <el-form-item v-else label=\"协议\">\n                                    <span>{{item['protocol']}}</span>\n                                </el-form-item>\n\n                                <el-form-item v-if=\"item['name'] && item['name'].indexOf('http') != -1\" label=\"状态\">\n                                    <el-tag effect=\"dark\" type=\"success\">{{item.web_fingerprint['status_code']}}</el-tag>\n                                    <span style=\"margin-left: 20%; font-weight: 600; color: #606266\">Web指纹 </span><el-button @click=\"web_dialog=!web_dialog\">获取</el-button>\n                                </el-form-item>\n                                <el-form-item v-else label=\"状态\">\n                                    <el-tag effect=\"dark\" type=\"success\">{{item.state}}</el-tag>\n                                </el-form-item>\n                                <el-form-item label=\"实例ID\">\n                                    <el-input v-model=\"item.instance_id\" disabled style=\"width:250px\"></el-input>\n                                </el-form-item>\n                                <el-form-item label=\"应用\">\n                                    <el-tag v-if=\"item.product\" type=\"success\">{{item.product}}</el-tag><span> </span>\n                                    <el-tag v-if=\"item.version\">{{item.version}}</el-tag>\n                                    <el-tag v-if=\"!item.product\" type=\"success\">Unkown</el-tag>\n                                </el-form-item>\n                                <el-dialog title=\"Web指纹\" :visible.sync=\"web_dialog\" width=\"30%\">\n                                    <pre overflow=\"hidden\">{{item.web_fingerprint}}</pre>\n                                </el-dialog>\n                            </el-form>\n                            <el-dialog title=\"漏洞详情\" :visible.sync=\"dialog\" width=\"80%\">\n                                <pre overflow=\"hidden\">{{vul_info}}</pre>\n                            </el-dialog>\n                            <!--AWVS table-->\n                            <el-table :data=\"item.vulnerabilities\" style=\"width: 100%\" border height=\"500px\" :row-class-name=\"tableRowClassName\" >\n                                <el-table-column label=\"漏洞名称\" width=\"180\" align=\"center\" fixed>\n                                    <template slot-scope=\"{row}\"><span>{{ row.vt_name }}</span></template>\n                                </el-table-column>\n                                <el-table-column label=\"Affects_URL\" width=\"180\" align=\"center\" fixed>\n                                    <template slot-scope=\"{row}\"><span>{{ row.affects_url }}</span></template>\n                                </el-table-column>\n                                <el-table-column label=\"渗透方式\" width=\"160\" align=\"center\">\n                                    <template slot-scope=\"{row}\"><span>{{ row.method }}</span></template>\n                                </el-table-column>\n                                <el-table-column label=\"Tags\" width=\"220\" align=\"center\">\n                                    <template slot-scope=\"{row}\"><span>{{ row.tags }}</span></template>\n                                </el-table-column>\n                                <el-table-column label=\"漏洞复现\" width=\"300\" align=\"center\" :show-overflow-tooltip=\"true\">\n                                    <template slot-scope=\"{row}\"><span>{{ row.attack_result }}</span></template>\n                                </el-table-column>\n                                <el-table-column label=\"exploit\" width=\"180\" align=\"center\">\n                                    <template slot-scope=\"{row}\"><span>{{ row.exploit }}</span></template>\n                                </el-table-column>\n                                <el-table-column label=\"payload\" width=\"400\" align=\"center\" :show-overflow-tooltip=\"true\">\n                                    <template slot-scope=\"{row}\"><span>{{ row.payload }}</span></template>\n                                </el-table-column>\n                                <el-table-column label=\"操作\" width=\"80\" align=\"center\" fixed=\"right\">\n                                    <template slot-scope=\"{row}\">\n                                        <el-button type=\"primary\" size=\"mini\" class=\"operation-btn\" @click=\"vul_detail(row)\">详情</el-button>\n                                    </template>\n                                </el-table-column>\n                            </el-table>\n                        </el-tab-pane>   \n                    </el-tabs>\n                    <el-tabs v-if=\"list.length===0\" tab-position=\"left\" type=\"border-card\" style=\"height: 400px;\">\n                        <el-tab-pane label=\"null\">\n                            <el-form ref=\"form\" label-width=\"80px\" size=\"mini\">\n                                <el-form-item></el-form-item>\n                                <el-form-item label=\"协议\"><el-tag type=\"info\">Null</el-tag></el-form-item>\n                                <el-form-item label=\"实例ID\"><el-input disabled style=\"width:250px\"></el-input></el-form-item>\n                                <el-form-item label=\"应用\"><el-tag type=\"success\">Unkown</el-tag></el-form-item>\n                            </el-form>\n                            <el-table v-model=\"list\" style=\"width: 100%\" border height=\"200px\" :row-class-name=\"tableRowClassName\" >\n                                <el-table-column label=\"漏洞名称\" width=\"180\" align=\"center\" fixed>\n                                    <template slot-scope=\"{row}\"><span>{{ row.vt_name }}</span></template>\n                                </el-table-column>\n                                <el-table-column label=\"Affects_URL\" width=\"180\" align=\"center\" fixed>\n                                    <template slot-scope=\"{row}\"><span>{{ row.affects_url }}</span></template>\n                                </el-table-column>\n                                <el-table-column label=\"渗透方式\" width=\"160\" align=\"center\">\n                                    <template slot-scope=\"{row}\"><span>{{ row.method }}</span></template>\n                                </el-table-column>\n                                <el-table-column label=\"Tags\" width=\"220\" align=\"center\">\n                                    <template slot-scope=\"{row}\"><span>{{ row.tags }}</span></template>\n                                </el-table-column>\n                                <el-table-column label=\"漏洞复现\" width=\"300\" align=\"center\" :show-overflow-tooltip=\"true\">\n                                    <template slot-scope=\"{row}\"><span>{{ row.attack_result }}</span></template>\n                                </el-table-column>\n                                <el-table-column label=\"exploit\" width=\"180\" align=\"center\">\n                                    <template slot-scope=\"{row}\"><span>{{ row.exploit }}</span></template>\n                                </el-table-column>\n                                <el-table-column label=\"payload\" width=\"400\" align=\"center\" :show-overflow-tooltip=\"true\">\n                                    <template slot-scope=\"{row}\"><span>{{ row.payload }}</span></template>\n                                </el-table-column>\n                                <el-table-column label=\"操作\" width=\"80\" align=\"center\" fixed=\"right\">\n                                    <template slot-scope=\"{row}\">\n                                        <el-button type=\"primary\" size=\"mini\" class=\"operation-btn\" @click=\"vul_detail(row)\">详情</el-button>\n                                    </template>\n                                </el-table-column>\n                            </el-table>\n                        </el-tab-pane>   \n                    </el-tabs>\n                </div>\n           </div>\n      </div>\n  </div>\n</template>\n\n<script>\nimport { InfoDetail, PortInfoList, PortInfoDetail } from \"@/api/instance\"\nimport waves from \"@/directive/waves\";\n\nexport default {\n    name: \"instance_info\",\n    directives: { waves },\n    data() {\n      return {\n        pannel1: true,\n        pannel2: true,\n        tableKey: 0,\n        tableKey1: 1,\n        banner: [],\n        dialog: false,\n        web_dialog: false,\n        service_loading: true,\n        form: {\n            \"_id\": \"string\",\n            \"create_at\": \"string\",\n            \"host\": \"string\",\n            \"hostname\": \"string\",\n            \"hostname_type\": \"string\",\n            \"is_delete\": 0,\n            \"mac\": \"string\",\n            \"name\": \"string\",\n            \"port_list\": [0],\n            \"portid_list\": [\"string\"], // [-]\n            \"target\": \"string\",\n            \"update_at\": \"string\",\n            \"vendor\": \"string\"\n        },\n        list: [],\n        open_port:[],\n        vul_info:{},\n      };\n    },\n    created(){\n        let id = this.$route.query.instance_id\n        this.getDetail(id)\n    },\n    methods: {\n        tableRowClassName({row}) {\n            if (row.severity === 3) {return 'danger-row'}\n            else if (row.severity === 2) {return 'warning-row'}\n            return 'success-row';\n        },\n        vul_detail(row){\n            this.dialog = true\n            this.vul_info = row\n        },\n        getDetail(id) {\n            let query = { instance_id: id }\n            InfoDetail(query).then((response) => {\n                let resp = response.data\n                this.banner =[resp.host, resp.hostname, resp.hostname_type, resp.mac, resp.vendor]\n                this.form = resp\n                this.list = response.data.portinfo_list\n                for(let i=0;i<this.list.length;i++){\n                    if(this.list[i].vulnerabilities.length>0){\n                        this.open_port.push(Number(this.list[i].port))\n                    }\n                }\n                console.log(this.open_port)\n                setTimeout(() => { this.isLoading = false; this.service_loading = false }, 1 * 1000);\n            });\n        },\n    }\n};\n</script>\n\n<style>\npre {\n    white-space: pre-wrap;\n    word-wrap: break-word;\n}\n.el-table .warning-row {\n    background: rgb(255, 247, 233);\n}\n\n.el-table .success-row {\n    background: #f3fdee;\n}\n.el-table .danger-row {\nbackground: #fde7e7;\n}\n</style>\n\n<style lang=\"scss\" scoped>\n.dashboard-editor-container {\n  padding: 32px;\n  background-color: rgb(239, 239, 240);\n  position: relative;\n\n  .github-corner {\n    position: absolute;\n    top: 0px;\n    border: 0;\n    right: 0;\n  }\n\n  .chart-wrapper {\n    background: #fff;\n    padding: 16px 16px 0;\n    margin-bottom: 32px;\n  }\n}\n\n@media (max-width:1024px) {\n  .chart-wrapper {\n    padding: 8px;\n  }\n}\n.page-header, .info-content{\n   padding: 2%;\n   background-color:#fff; \n}\n.info-content{\n    margin-top: 1%;\n}\n\n</style>"],"sourceRoot":"src/views/instance"}]}