{"remainingRequest":"/home/views/opentest_view/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/views/opentest_view/src/views/mars/task_update.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/views/opentest_view/src/views/mars/task_update.vue","mtime":1600226029963},{"path":"/home/views/opentest_view/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/views/opentest_view/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/views/opentest_view/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/views/opentest_view/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCi8vIGltcG9ydCB7IGNoYWluQWRkQmxvY2ssIGJsb2NrRGV0YWlsLCBjaGFpblVwZGF0ZUJsb2NrIH0gZnJvbSAiQC9hcGkvY2hhaW4iOwpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGlzRWRpdEl0ZW06IGZhbHNlLAogICAgICBpc0VkaXRQYWdlOiBmYWxzZSwgLy/mmK/liJvlu7rov5jmmK/kv67mlLnpobXpnaLvvJ8KICAgICAgc3VibWl0QnRuRGlzYWJsZWQ6IGZhbHNlLAogICAgICB0aXRsZTogIuWIm+W7uuS7u+WKoSIsCiAgICAgIGZvcm06IHsKICAgICAgICB0YXNrX25hbWU6ICIiLAogICAgICAgIHRhcmdldF9saXN0OiAiIiwgLy9cbiAtPiAsIOaNouihjOabtOaNoumAl+WPtwogICAgICAgIG9wZW5fd2ViOiAwLAogICAgICAgIHNjYW5fdHlwZTogdW5kZWZpbmVkLCAvL+WujOWFqOaJq+aPjwogICAgICAgIG9wZW5fcG9jOiAwLAogICAgICAgIHByb3RvY29sOiBbXSwgIC8v5Y2P6K6uIG1zZiBzZWFyY2ggeHh4CiAgICAgICAgb3Blbl9leHA6IDAsCiAgICAgIH0sCiAgICAgIG9wdGlvbnM6IFsiU01CIiwgIkZUUCIsICJSRFAiLCAiU1NIIl0sCiAgICB9OwogIH0sCiAgY3JlYXRlZCgpIHsKICAgIGxldCBpZCA9IHRoaXMuJHJvdXRlLnF1ZXJ5LmlkCiAgICBpZiAoaWQpIHsgLy/ngrnlh7vkv67mlLnpobXpnaLnmoTot7PovaxpZCB1cmnlj4LmlbAoP2lkPTY0KQogICAgICAvLyDlpoLmnpzmnIlpZCzmn6VEQui/m+ihjOi1i+WAvAogICAgICB0aGlzLnRpdGxlID0gIuS/ruaUueS7u+WKoSIKICAgICAgdGhpcy5pc0VkaXRQYWdlID0gdHJ1ZQogICAgICB0aGlzLmlzTG9hZGluZyA9IHRydWUKICAgICAgdGhpcy5ibG9ja19pZCA9IE51bWJlcihpZCkKICAgICAgLy8gICB0aGlzLmdldERldGFpbChpZCkKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIC8vIOabtOaWsOe7hOS7tumFjee9rgogICAgLy8gb25VcGRhdGUoKSB7CiAgICAvLyAgIGlmICh0aGlzLmZvcm0uYmxvY2tfbmFtZSA9PSAiIikgeyB0aGlzLiRtZXNzYWdlKHsgbWVzc2FnZTogIue7hOS7tuWQjeW/heWhqyIsIHR5cGU6ICJ3YXJuaW5nIiB9KTsgcmV0dXJuIH0KICAgIC8vICAgaWYgKHRoaXMuZm9ybS5wcmlvcml0eSA8IDEpIHsgdGhpcy4kbWVzc2FnZSh7IG1lc3NhZ2U6ICLph43opoHmgKflv4XpgIkiLCB0eXBlOiAid2FybmluZyIgfSk7IHJldHVybiB9CiAgICAvLyAgIGlmICh0aGlzLmxpc3QubGVuZ3RoID09IDApIHsgdGhpcy4kbWVzc2FnZSh7IG1lc3NhZ2U6ICLliqjkvZzliJfooajkuLrnqboiLCB0eXBlOiAid2FybmluZyIgfSk7IHJldHVybiB9CiAgICAvLyAgIHRoaXMuc3VibWl0QnRuRGlzYWJsZWQgPSB0cnVlCiAgICAvLyAgIC8vMS7nu4Too4XmlbDmja4KICAgIC8vICAgbGV0IHBvc3REYXRhID0geyBpZDogdGhpcy5ibG9ja19pZCwgYmxvY2tfbmFtZTogdGhpcy5mb3JtLmJsb2NrX25hbWUsIHByaW9yaXR5OiB0aGlzLmZvcm0ucHJpb3JpdHksIGV4cGVjdDogdGhpcy5mb3JtLmV4cGVjdCwgYWN0aW9uX2NoYWluOiB0aGlzLmxpc3QgfQogICAgLy8gICAvLzIu6LCDQVBJ5o6l5Y+jCiAgICAvLyAgIGNoYWluVXBkYXRlQmxvY2socG9zdERhdGEpLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAvLyAgICAgdGhpcy5zdWJtaXRCdG5EaXNhYmxlZCA9IGZhbHNlOwogICAgLy8gICAgIHRoaXMuY2xlYXJGb3JtRGF0YSgpOwogICAgLy8gICAgIHRoaXMuJG5vdGlmeSh7IHRpdGxlOiAiU3VjY2VzcyIsIG1lc3NhZ2U6ICLmm7TmlrDmiJDlip8gW2lkOiIgKyB0aGlzLmJsb2NrX2lkICsgIl0iICsgcmVzcG9uc2UuZGF0YS5lcnJtc2csIHR5cGU6ICJzdWNjZXNzIiwgZHVyYXRpb246IDUwMDAsIH0pOwogICAgLy8gICAgIHRoaXMuJHJvdXRlci5nbygtMSkKICAgIC8vICAgfSkuY2F0Y2goKCkgPT4gewogICAgLy8gICAgIHRoaXMuc3VibWl0QnRuRGlzYWJsZWQgPSBmYWxzZTsKICAgIC8vICAgICB0aGlzLiRub3RpZnkoeyB0aXRsZTogIkZhaWxlZCIsIG1lc3NhZ2U6ICLmm7TmlrDlpLHotKUgW2lkOiIgKyB0aGlzLmJsb2NrX2lkICsgIl0iLCB0eXBlOiAiZXJyb3IiLCBkdXJhdGlvbjogNTAwMCwgfSk7CiAgICAvLyAgIH0pOwogICAgLy8gfSwKICAgIC8v5o+Q5Y+K5Yib5bu657uE5Lu2CiAgICBvblN1Ym1pdCgpIHsKICAgICAgaWYgKHRoaXMuZm9ybS50YXNrX25hbWUgPT0gIiIpIHsgdGhpcy4kbWVzc2FnZSh7IG1lc3NhZ2U6ICLku7vliqHlkI3lv4XloasiLCB0eXBlOiAid2FybmluZyIgfSk7IHJldHVybiB9CiAgICAgIGlmICh0aGlzLmZvcm0udGFyZ2V0X2xpc3QgPT0gIiIpIHsgdGhpcy4kbWVzc2FnZSh7IG1lc3NhZ2U6ICLku7vliqHnm67moIflv4XloasiLCB0eXBlOiAid2FybmluZyIgfSk7IHJldHVybiB9CiAgICAgIGlmICh0aGlzLmZvcm0ub3Blbl93ZWIgPT0gMSkgewogICAgICAgIGlmICghdGhpcy5mb3JtLnNjYW5fdHlwZSkgeyB0aGlzLiRtZXNzYWdlKHsgbWVzc2FnZTogIuaJq+aPj+exu+Wei+W/heWhqyIsIHR5cGU6ICJ3YXJuaW5nIiB9KTsgcmV0dXJuIH0KICAgICAgfQogICAgICBpZiAodGhpcy5mb3JtLm9wZW5fcG9jID09IDEpIHsKICAgICAgICBpZiAodGhpcy5mb3JtLnByb3RvY29sLmxlbmd0aCA9PSAwKSB7IHRoaXMuJG1lc3NhZ2UoeyBtZXNzYWdlOiAi5Y2P6K6u5b+F5aGrIiwgdHlwZTogIndhcm5pbmciIH0pOyByZXR1cm4gfQogICAgICB9CiAgICAgIC8vICAgdGhpcy5zdWJtaXRCdG5EaXNhYmxlZCA9IHRydWUKICAgICAgLy8xLue7hOijheaVsOaNrgogICAgICB0aGlzLmZvcm0udGFyZ2V0X2xpc3QgPSB0aGlzLmZvcm0udGFyZ2V0X2xpc3QucmVwbGFjZSgvXG4vZywgIiwiKTsKICAgICAgLy8gICBsZXQgcG9zdERhdGEgPSB7IGJsb2NrX25hbWU6IHRoaXMuZm9ybS5ibG9ja19uYW1lLCBwcmlvcml0eTogdGhpcy5mb3JtLnByaW9yaXR5LCBleHBlY3Q6IHRoaXMuZm9ybS5leHBlY3QsIGFjdGlvbl9jaGFpbjogdGhpcy5saXN0IH0KICAgICAgLy8yLuiwg0FQSeaOpeWPowogICAgICBjb25zb2xlLmxvZyh0aGlzLmZvcm0pCiAgICAgIGNvbnNvbGUubG9nKHRoaXMuZm9ybS5wcm90b2NvbCkKICAgICAgY29uc29sZS5sb2codGhpcy5mb3JtLnRhcmdldF9saXN0KQogICAgICAvLyAgIGNoYWluQWRkQmxvY2socG9zdERhdGEpLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgIC8vICAgICB0aGlzLnN1Ym1pdEJ0bkRpc2FibGVkID0gZmFsc2U7CiAgICAgIC8vICAgICB0aGlzLmNsZWFyRm9ybURhdGEoKTsKICAgICAgLy8gICAgIHRoaXMuJG5vdGlmeSh7IHRpdGxlOiAiU3VjY2VzcyIsIG1lc3NhZ2U6ICLmt7vliqDmiJDlip8iICsgcmVzcG9uc2UuZGF0YS5lcnJtc2csIHR5cGU6ICJzdWNjZXNzIiwgZHVyYXRpb246IDUwMDAsIH0pOwogICAgICAvLyAgIH0pLmNhdGNoKCgpID0+IHsKICAgICAgLy8gICAgIHRoaXMuc3VibWl0QnRuRGlzYWJsZWQgPSBmYWxzZTsKICAgICAgLy8gICB9KTsKICAgIH0sCiAgICAvLyDmj5DkuqTmiJDlip/muIXnqbrlvZPliY3pobXpnaLmlbDmja4KICAgIGNsZWFyRm9ybURhdGEoKSB7CiAgICB9LAogICAgZ2V0RGV0YWlsKGlkKSB7CiAgICAgIGNvbnNvbGUubG9nKGlkKQogICAgfSwKICB9Cn0K"},{"version":3,"sources":["task_update.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"task_update.vue","sourceRoot":"src/views/mars","sourcesContent":["<template>\n  <div class=\"mixin-components-container\">\n    <el-row>\n      <el-card class=\"box-card\">\n        <div slot=\"header\" class=\"clearfix\">\n          <span>{{title}}</span>\n        </div>\n        <div style=\"margin-bottom:50px;\">\n          <el-form ref=\"form\" :model=\"form\" label-width=\"140px\">\n            <el-form-item label=\"任务名\" class=\"is-required\">\n              <el-input v-model=\"form.task_name\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"任务目标\" class=\"is-required\">\n              <el-input type=\"textarea\" v-model=\"form.target_list\" :autosize=\"{ minRows: 2, maxRows: 4}\" placeholder=\"格式:http://example.com,多条换行\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"开启Web漏洞扫描\">\n              <el-switch v-model=\"form.open_web\" active-color=\"#13ce66\" :active-value=\"1\" :inactive-value=\"0\" />\n            </el-form-item>\n            <el-form-item v-if=\"form.open_web\" label=\"扫描类型\">\n              <el-select v-model=\"form.scan_type\" placeholder=\"请选择\" style=\"width:200px\">\n                <el-option label=\"完全扫描\" :value=\"1\"></el-option>\n                <el-option label=\"高危扫描\" :value=\"2\"></el-option>\n                <el-option label=\"XSS检测\" :value=\"3\"></el-option>\n                <el-option label=\"SQL注入\" :value=\"4\"></el-option>\n                <el-option label=\"弱口令检测\" :value=\"5\"></el-option>\n                <el-option label=\"Web指纹\" :value=\"6\"></el-option>\n              </el-select>\n            </el-form-item>\n            <el-form-item label=\"开启Poc检测\">\n              <el-switch v-model=\"form.open_poc\" active-color=\"#13ce66\" :active-value=\"1\" :inactive-value=\"0\" />\n            </el-form-item>\n            <el-form-item v-if=\"form.open_poc\" label=\"选择协议\">\n              <el-select v-model=\"form.protocol\" multiple placeholder=\"请选择\" size=\"medium\">\n                <el-option v-for=\"(index,item) in options\" :key=\"item\" :label=\"index\" :value=\"index\"></el-option>\n              </el-select>\n            </el-form-item>\n            <el-form-item label=\"开启漏洞利用\">\n              <el-switch v-model=\"form.open_exp\" active-color=\"#FF4500\" :active-value=\"1\" :inactive-value=\"0\" />\n            </el-form-item>\n            <el-form-item>\n              <el-button v-if=\"isEditPage\" type=\"danger\" :disabled=\"submitBtnDisabled\" @click=\"onUpdate()\">提交修改</el-button>\n              <el-button v-else type=\"primary\" :disabled=\"submitBtnDisabled\" @click=\"onSubmit()\">立即创建</el-button>\n            </el-form-item>\n          </el-form>\n        </div>\n      </el-card>\n    </el-row>\n  </div>\n</template>\n\n<script>\n// import { chainAddBlock, blockDetail, chainUpdateBlock } from \"@/api/chain\";\nexport default {\n  data() {\n    return {\n      isEditItem: false,\n      isEditPage: false, //是创建还是修改页面？\n      submitBtnDisabled: false,\n      title: \"创建任务\",\n      form: {\n        task_name: \"\",\n        target_list: \"\", //\\n -> , 换行更换逗号\n        open_web: 0,\n        scan_type: undefined, //完全扫描\n        open_poc: 0,\n        protocol: [],  //协议 msf search xxx\n        open_exp: 0,\n      },\n      options: [\"SMB\", \"FTP\", \"RDP\", \"SSH\"],\n    };\n  },\n  created() {\n    let id = this.$route.query.id\n    if (id) { //点击修改页面的跳转id uri参数(?id=64)\n      // 如果有id,查DB进行赋值\n      this.title = \"修改任务\"\n      this.isEditPage = true\n      this.isLoading = true\n      this.block_id = Number(id)\n      //   this.getDetail(id)\n    }\n  },\n  methods: {\n    // 更新组件配置\n    // onUpdate() {\n    //   if (this.form.block_name == \"\") { this.$message({ message: \"组件名必填\", type: \"warning\" }); return }\n    //   if (this.form.priority < 1) { this.$message({ message: \"重要性必选\", type: \"warning\" }); return }\n    //   if (this.list.length == 0) { this.$message({ message: \"动作列表为空\", type: \"warning\" }); return }\n    //   this.submitBtnDisabled = true\n    //   //1.组装数据\n    //   let postData = { id: this.block_id, block_name: this.form.block_name, priority: this.form.priority, expect: this.form.expect, action_chain: this.list }\n    //   //2.调API接口\n    //   chainUpdateBlock(postData).then((response) => {\n    //     this.submitBtnDisabled = false;\n    //     this.clearFormData();\n    //     this.$notify({ title: \"Success\", message: \"更新成功 [id:\" + this.block_id + \"]\" + response.data.errmsg, type: \"success\", duration: 5000, });\n    //     this.$router.go(-1)\n    //   }).catch(() => {\n    //     this.submitBtnDisabled = false;\n    //     this.$notify({ title: \"Failed\", message: \"更新失败 [id:\" + this.block_id + \"]\", type: \"error\", duration: 5000, });\n    //   });\n    // },\n    //提及创建组件\n    onSubmit() {\n      if (this.form.task_name == \"\") { this.$message({ message: \"任务名必填\", type: \"warning\" }); return }\n      if (this.form.target_list == \"\") { this.$message({ message: \"任务目标必填\", type: \"warning\" }); return }\n      if (this.form.open_web == 1) {\n        if (!this.form.scan_type) { this.$message({ message: \"扫描类型必填\", type: \"warning\" }); return }\n      }\n      if (this.form.open_poc == 1) {\n        if (this.form.protocol.length == 0) { this.$message({ message: \"协议必填\", type: \"warning\" }); return }\n      }\n      //   this.submitBtnDisabled = true\n      //1.组装数据\n      this.form.target_list = this.form.target_list.replace(/\\n/g, \",\");\n      //   let postData = { block_name: this.form.block_name, priority: this.form.priority, expect: this.form.expect, action_chain: this.list }\n      //2.调API接口\n      console.log(this.form)\n      console.log(this.form.protocol)\n      console.log(this.form.target_list)\n      //   chainAddBlock(postData).then((response) => {\n      //     this.submitBtnDisabled = false;\n      //     this.clearFormData();\n      //     this.$notify({ title: \"Success\", message: \"添加成功\" + response.data.errmsg, type: \"success\", duration: 5000, });\n      //   }).catch(() => {\n      //     this.submitBtnDisabled = false;\n      //   });\n    },\n    // 提交成功清空当前页面数据\n    clearFormData() {\n    },\n    getDetail(id) {\n      console.log(id)\n    },\n  }\n}\n</script>\n\n<style>\n.mixin-components-container {\n  background-color: #f0f2f5;\n  padding: 30px;\n  min-height: calc(100vh - 84px);\n}\n.text {\n  font-size: 14px;\n}\n.clearfix:before,\n.clearfix:after {\n  display: table;\n  content: \"\";\n}\n.clearfix:after {\n  clear: both;\n}\n.box-card-in {\n  width: 60%;\n}\n.dump-box {\n  font-weight: 700;\n  color: #606266;\n}\n</style>"]}]}