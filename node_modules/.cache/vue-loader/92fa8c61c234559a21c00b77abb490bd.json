{"remainingRequest":"/home/views/aquaman_view/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/views/aquaman_view/src/views/instance/info.vue?vue&type=style&index=0&id=27258a3e&lang=scss&scoped=true&","dependencies":[{"path":"/home/views/aquaman_view/src/views/instance/info.vue","mtime":1603363673835},{"path":"/home/views/aquaman_view/node_modules/css-loader/dist/cjs.js","mtime":1601261329179},{"path":"/home/views/aquaman_view/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1601261366078},{"path":"/home/views/aquaman_view/node_modules/postcss-loader/src/index.js","mtime":1601261365169},{"path":"/home/views/aquaman_view/node_modules/sass-loader/dist/cjs.js","mtime":1601261354159},{"path":"/home/views/aquaman_view/node_modules/cache-loader/dist/cjs.js","mtime":1601261325203},{"path":"/home/views/aquaman_view/node_modules/vue-loader/lib/index.js","mtime":1601261366062}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5kYXNoYm9hcmQtZWRpdG9yLWNvbnRhaW5lciB7CiAgcGFkZGluZzogMzJweDsKICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2IoMjM5LCAyMzksIDI0MCk7CiAgcG9zaXRpb246IHJlbGF0aXZlOwoKICAuZ2l0aHViLWNvcm5lciB7CiAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICB0b3A6IDBweDsKICAgIGJvcmRlcjogMDsKICAgIHJpZ2h0OiAwOwogIH0KCiAgLmNoYXJ0LXdyYXBwZXIgewogICAgYmFja2dyb3VuZDogI2ZmZjsKICAgIHBhZGRpbmc6IDE2cHggMTZweCAwOwogICAgbWFyZ2luLWJvdHRvbTogMzJweDsKICB9Cn0KCkBtZWRpYSAobWF4LXdpZHRoOjEwMjRweCkgewogIC5jaGFydC13cmFwcGVyIHsKICAgIHBhZGRpbmc6IDhweDsKICB9Cn0KLnBhZ2UtaGVhZGVyLCAuaW5mby1jb250ZW50ewogICBwYWRkaW5nOiAyJTsKICAgYmFja2dyb3VuZC1jb2xvcjojZmZmOyAKfQouaW5mby1jb250ZW50ewogICAgbWFyZ2luLXRvcDogMSU7Cn0KLmVsLXRhYmxlIC53YXJuaW5nLXJvdyB7CiAgICBiYWNrZ3JvdW5kOiByZ2IoMjU1LCAyMTQsIDEzOSk7CiAgfQoKLmVsLXRhYmxlIC5zdWNjZXNzLXJvdyB7CmJhY2tncm91bmQ6ICNkNWZkYzA7Cn0K"},{"version":3,"sources":["info.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2OA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"info.vue","sourceRoot":"src/views/instance","sourcesContent":["<template>\n  <div class=\"dashboard-editor-container\">\n      <div v-if=\"page_type==2\" class=\"app-container\">\n           <div class=\"page-header\">\n                <button class=\"pan-btn pink-btn\" v-if=\"pannel1\" @click=\"pannel1=!pannel1\">[ - ] 站点信息</button>\n                <button class=\"pan-btn pink-btn\" v-else @click=\"pannel1=!pannel1\">[+] 站点信息</button>\n                <el-form ref=\"form\" v-if=\"pannel1\" :model=\"form\" label-width=\"80px\" size=\"mini\">\n                    <el-form-item></el-form-item>\n                    <el-form-item label=\"资产名称\">\n                        <el-tag type=\"info\">{{form.name}}</el-tag>\n                        <!-- <el-tag type=\"success\">{{form.state}}</el-tag> -->\n                    </el-form-item>\n                    <el-form-item label=\"Target\">\n                        <el-input v-model=\"form.target\" disabled></el-input>\n                    </el-form-item>\n                    <el-form-item label=\"IP 信息\">\n                        <el-tag type=\"info\">{{form.host}}</el-tag>\n                        <el-tag type=\"info\">中国广东深圳</el-tag>\n                    </el-form-item>\n                    <el-form-item label=\"创建时间\">\n                        <el-tag type=\"info\">{{form.create_at}}</el-tag>\n                    </el-form-item>\n                    <el-form-item label=\"更新时间\">\n                        <el-tag type=\"info\">{{form.update_at}}</el-tag>\n                    </el-form-item>\n                   <el-form-item label=\"检测状态\" min-width=\"20px\"> <!--align=\"center\"-->\n                        <el-tag v-if=\"form.status=='Completed'\" effect=\"dark\" type=\"success\">\n                            <i  class=\"el-icon-finished\">{{ form.status }}</i>\n                        </el-tag>\n                        <el-tag v-else-if=\"form.status=='New'\">\n                            <i  class=\"el-icon-video-play\">{{ form.status }}</i>\n                        </el-tag>\n                        <el-tag v-else>\n                            <i  class=\"el-icon-loading\">{{ form.status }}</i>\n                        </el-tag>\n                    </el-form-item>\n                    <el-form-item label=\"Banner\">\n                        <el-checkbox-group v-model=\"banner\" fill=\"#FFA500\">\n                            <el-checkbox-button :label=\"form.host\" name=\"type\"></el-checkbox-button>\n                            <el-checkbox-button :label=\"form.hostname\" name=\"type\"></el-checkbox-button>\n                            <el-checkbox-button :label=\"form.hostname_type\" name=\"type\"></el-checkbox-button>\n                            <el-checkbox-button :label=\"form.mac\" name=\"type\"></el-checkbox-button>\n                            <el-checkbox-button :label=\"form.vendor\" name=\"type\"></el-checkbox-button>\n                        </el-checkbox-group>\n                    </el-form-item>\n                    <el-form-item label=\"高危端口\">\n                        <el-checkbox-group v-model=\"open_port\" fill=\"#CD0000\">\n                            <el-checkbox-button v-for=\"(j,jj) in form.port_list\" :key=\"jj\" :label=\"j\" name=\"type\"></el-checkbox-button>\n                        </el-checkbox-group>\n                    </el-form-item>\n                </el-form>\n           </div>\n           <div class=\"info-content\">\n                <button class=\"pan-btn green-btn\" v-if=\"pannel2\" @click=\"pannel2=!pannel2\">[ - ] 服务漏洞</button>\n                <button class=\"pan-btn green-btn\" v-else @click=\"pannel2=!pannel2\">[+] 服务漏洞</button>\n                <p />\n                \n                <el-tabs tab-position=\"left\" type=\"border-card\" style=\"height: 400px;\">\n                    <el-tab-pane v-for=\"(item, index) in list\" :key=\"index\" :label=\"item.port\">\n                        <!---->\n                        <span> xxx</span>\n                        <!--table-->\n                        <el-table :data=\"item.vulnerabilities\" style=\"width: 100%\" :row-class-name=\"tableRowClassName\">\n                            <el-table-column label=\"日期\" width=\"180\">\n                                <template slot-scope=\"{row}\">\n                                    <span>{{ row.vt_name }}</span>\n                                </template>\n                            </el-table-column>\n                            <el-table-column label=\"姓名\" width=\"180\">\n                            </el-table-column>\n                            <el-table-column label=\"地址\">\n                            </el-table-column>\n                        </el-table>\n                            <!-- {{item.vulnerabilities}} -->\n                    </el-tab-pane>   \n                </el-tabs>\n           </div>\n           <div class=\"info-content\">\n                <!--弹出框-->\n                <el-dialog title=\"端口详情\" :visible.sync=\"port_dialog\">\n                    <p>{{port_dialogdata}}</p>\n                    <span slot=\"footer\" class=\"dialog-footer\">\n                        <el-button @click=\"port_dialog = false\">关 闭</el-button>\n                    </span>\n                </el-dialog>\n                <button class=\"pan-btn green-btn\" v-if=\"pannel2\" @click=\"pannel2=!pannel2\">[ - ] 服务漏洞</button>\n                <button class=\"pan-btn green-btn\" v-else @click=\"pannel2=!pannel2\">[+] 服务漏洞</button>\n                <el-form ref=\"form\" v-if=\"pannel2\" label-width=\"80px\" size=\"mini\">\n                    <el-form-item></el-form-item>\n                    <el-table :key=\"tableKey\" :data=\"list\" border fit highlight-current-row style=\"width: 100%;\">\n                        <el-table-column label=\"端口\" min-width=\"15px\" align=\"center\">\n                            <template slot-scope=\"{row}\">\n                                <span>{{ row.port }}</span>\n                            </template>\n                        </el-table-column>\n                        <el-table-column label=\"状态\" min-width=\"15px\" align=\"center\">\n                            <template slot-scope=\"{row}\">\n                                <span>{{ row.state }}</span>\n                            </template>\n                        </el-table-column>\n                        <el-table-column label=\"服务\" min-width=\"18px\" align=\"center\">\n                            <template slot-scope=\"{row}\">\n                                <span v-if=\"row.product\">{{ row.product }}-{{ row.version }}</span>\n                                <span v-else>{{row.name}}</span>\n                            </template>\n                        </el-table-column>\n                        <el-table-column label=\"协议\" min-width=\"10px\" align=\"center\">\n                            <template slot-scope=\"{row}\"><span>{{ row.protocol }}</span></template>\n                        </el-table-column>\n                        <el-table-column label=\"type\" min-width=\"10px\" align=\"center\">\n                            <template slot-scope=\"{row}\"><span>{{ row.vul_type }}</span></template>\n                        </el-table-column>\n                        <el-table-column label=\"潜在威胁(高危)\" min-width=\"50px\" align=\"center\">\n                        <template slot-scope=\"{row}\">\n                            <p v-for=\"(vul, d) in row.vulnerabilities\" :key=\"d\">\n                                <span v-if=\"vul.severity > 2\">{{ vul.vt_name }}</span>\n                            </p>\n                        </template>\n                        </el-table-column>\n                        <el-table-column label=\"漏洞复现\" min-width=\"50px\" align=\"center\">\n                            <template slot-scope=\"{row}\">\n                                <p v-for=\"(vul, d) in row.vulnerabilities\" :key=\"d\">{{ vul.verify }}</p>\n                            </template>\n                        </el-table-column>\n                        <el-table-column label=\"渗透方式\" align=\"center\" width=\"80px\" class-name=\"small-padding fixed-width\">\n                            <template slot-scope=\"{row}\">\n                                <el-button v-if=\"row.vulnerabilities.length>0\" type=\"warning\" icon=\"el-icon-key\" circle></el-button>\n                            </template>\n                        </el-table-column>\n                        <el-table-column label=\"Operation\" align=\"center\" width=\"90px\" class-name=\"small-padding fixed-width\">\n                            <template slot-scope=\"{row,$index}\">\n                                <el-button type=\"primary\" size=\"mini\" class=\"operation-btn\" @click=\"portDetail(row,$index)\">详情</el-button>\n                                <!-- <el-button type=\"danger\" size=\"mini\" @click=\"handleDelete(row,$index)\" disabled>删除</el-button> -->\n                            </template>\n                        </el-table-column>\n                    </el-table>\n                </el-form>\n           </div>\n      </div>\n  </div>\n</template>\n\n<script>\n// import { InfoDetail } from \"@/api/asset\";\nimport { InfoDetail, PortInfoList, VulDetail } from \"@/api/instance\"\nimport waves from \"@/directive/waves\"; // waves directive\n\nexport default {\n    name: \"asset_info\",\n    directives: { waves },\n    data() {\n      return {\n        pannel1: true,\n        pannel2: true,\n        pannel3: true,\n        pannel4: true,\n        tableKey: 0,\n        tableKey1: 1,\n        page_type: 1, //1为创建资产,2为资产详情\n        banner: [],\n        port_dialog: false,\n        port_dialogdata: {},\n        mark_dialog: false,\n        mark_dialogdata:{},\n        form: {\n            \"_id\": \"string\",\n            \"create_at\": \"string\",\n            \"host\": \"string\",\n            \"hostname\": \"string\",\n            \"hostname_type\": \"string\",\n            \"is_delete\": 0,\n            \"mac\": \"string\",\n            \"name\": \"string\",\n            \"port_list\": [0],\n            \"portid_list\": [\"string\"], // [-]\n            \"target\": \"string\",\n            \"update_at\": \"string\",\n            \"vendor\": \"string\"\n        },\n        list: [],\n        open_port:[],\n      };\n    },\n    created(){\n        let id = this.$route.query.instance_id\n        if (id) {\n            this.page_type = 2\n            this.getDetail(id)\n            this.get_portinfo(id)\n        }else{ //创建POC任务\n        }\n    },\n    methods: {\n        onSubmit() {\n            console.log('submit!');\n        },\n        tableRowClassName({row,rowIndex}) {\n        if (rowIndex === 1) {\n            return 'warning-row';\n        } else if (rowIndex === 3) {\n            return 'success-row';\n        }\n            return '';\n        },\n        // 根据单个实例，获取它的端口信息列表\n        get_portinfo(instance_id){\n            let query = {page_no: 1, page_size: 1000, info: instance_id}\n            PortInfoList(query).then((response) => {\n                let list = response.data.list;\n                for (let i=0;i<list.length;i++){\n                    if (list[i].vulnerabilities.length > 0){\n                        this.open_port.push(Number(list[i].port))\n                        this.list.push(list[i])\n                    }\n                    if (list[i].target_id){\n                        this.open_port.push(Number(list[i].port))\n                    }   \n                }\n                console.log(this.list)\n            });\n        },\n        getDetail(id) {\n            let query = { instance_id: id }\n            InfoDetail(query).then((response) => {\n                let resp = response.data\n                this.banner =[resp.host, resp.hostname, resp.hostname_type, resp.mac, resp.vendor]\n                this.form = resp\n                setTimeout(() => { this.isLoading = false; }, 1.5 * 1000);\n            });\n        },\n    }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.dashboard-editor-container {\n  padding: 32px;\n  background-color: rgb(239, 239, 240);\n  position: relative;\n\n  .github-corner {\n    position: absolute;\n    top: 0px;\n    border: 0;\n    right: 0;\n  }\n\n  .chart-wrapper {\n    background: #fff;\n    padding: 16px 16px 0;\n    margin-bottom: 32px;\n  }\n}\n\n@media (max-width:1024px) {\n  .chart-wrapper {\n    padding: 8px;\n  }\n}\n.page-header, .info-content{\n   padding: 2%;\n   background-color:#fff; \n}\n.info-content{\n    margin-top: 1%;\n}\n.el-table .warning-row {\n    background: rgb(255, 214, 139);\n  }\n\n.el-table .success-row {\nbackground: #d5fdc0;\n}\n</style>"]}]}